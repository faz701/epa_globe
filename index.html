<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>2025 ‚Äî –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º | 3D Globe</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    background: radial-gradient(circle at center, #020617, #000);
    overflow: hidden;
    font-family: 'Inter', sans-serif;
  }

  #title {
    position: absolute;
    top: 24px;
    width: 100%;
    text-align: center;
    color: #e5e7eb;
    font-size: 28px;
    font-weight: 600;
    z-index: 10;
    letter-spacing: .5px;
  }

  #hint {
    position: absolute;
    bottom: 16px;
    width: 100%;
    text-align: center;
    color: #64748b;
    font-size: 12px;
    z-index: 10;
  }
</style>
</head>
<body>

<div id="title">2025 –≥–æ–¥ –≤ –Ω–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏ ‚Äî –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º</div>
<div id="hint">3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è ‚Ä¢ —Ä–µ–∂–∏–º –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏–∏</div>

<!-- CDN -->
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three-globe@2.27.3/dist/three-globe.min.js"></script>

<script>
// ======================
// –ù–ê–°–¢–†–û–ô–ö–ò
// ======================
const DATA_URL = "https://script.google.com/macros/s/AKfycbzxZeL9XhdOdlk1BeSpBsVGZ_62fQHS-TODEbKcfwGIx67-DMA-eCmZosM-SkCrRHsH/exec";
const PRESENTATION_MODE = true;
const WORD_COLOR = "#facc15";

// ======================
// FALLBACK
// ======================
const fallbackData = [
  { text: "–†–æ—Å—Ç", value: 5 },
  { text: "–ö–æ–º–∞–Ω–¥–∞", value: 3 },
  { text: "–†–∞–∑–≤–∏—Ç–∏–µ", value: 4 }
];

// ======================
// LOAD DATA
// ======================
fetch(DATA_URL)
  .then(r => r.json())
  .then(initGlobe)
  .catch(() => initGlobe(fallbackData));

// ======================
// INIT GLOBE
// ======================
function initGlobe(words) {

  console.log("INIT GLOBE", words);

  const globe = new ThreeGlobe({ THREE });

  // üåç –ó–µ–º–ª—è
  globe.globeImageUrl(
    "https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg"
  );

  globe.bumpImageUrl(
    "https://unpkg.com/three-globe/example/img/earth-topology.png"
  );

  // üå´ –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞
  globe.showAtmosphere(true);
  globe.atmosphereColor("#60a5fa");
  globe.atmosphereAltitude(0.25);

  // üî§ –°–ª–æ–≤–∞
  globe.labelsData(words);
  globe.labelLat(() => Math.random() * 180 - 90);
  globe.labelLng(() => Math.random() * 360 - 180);
  globe.labelText(d => d.text);
  globe.labelSize(d => 1.1 + d.value * 0.25);
  globe.labelColor(() => WORD_COLOR);
  globe.labelDotRadius(0.35);
  globe.labelAltitude(0.018);

  // ======================
  // SCENE
  // ======================
  const scene = new THREE.Scene();
  scene.add(globe);

  // CAMERA
  const camera = new THREE.PerspectiveCamera(
    55,
    window.innerWidth / window.innerHeight,
    0.1,
    2000
  );
  camera.position.z = 520;

  // RENDERER
  const renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setPixelRatio(window.devicePixelRatio);
  document.body.appendChild(renderer.domElement);

  // LIGHT
  scene.add(new THREE.AmbientLight(0xffffff, 0.6));
  const sunLight = new THREE.DirectionalLight(0xffffff, 1.2);
  sunLight.position.set(300, 200, 300);
  scene.add(sunLight);

  // ======================
  // ANIMATION
  // ======================
  let zoom = 520;
  let angle = 0;

  (function animate() {
    requestAnimationFrame(animate);

    globe.rotation.y += 0.0016;

    if (zoom > 360) zoom -= 0.05;
    camera.position.z = zoom;

    if (PRESENTATION_MODE) {
      angle += 0.0008;
      camera.position.x = Math.sin(angle) * 120;
      camera.position.y = Math.sin(angle * 0.7) * 60;
      camera.lookAt(scene.position);
    }

    renderer.render(scene, camera);
  })();

  // RESIZE
  window.addEventListener("resize", () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });
}
</script>

</body>
</html>
